<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Reference | web开发（LAN/WLAN）</title>
    <meta name="description" content="兼容局域网开发环境的前端开发经验">
    
    
    <link rel="preload" href="/assets/css/0.styles.05224627.css" as="style"><link rel="preload" href="/assets/js/app.f71b7fe6.js" as="script"><link rel="preload" href="/assets/js/13.7e3b4d4d.js" as="script"><link rel="prefetch" href="/assets/js/1.91d178da.js"><link rel="prefetch" href="/assets/js/2.624b4b0b.js"><link rel="prefetch" href="/assets/js/3.a03a035f.js"><link rel="prefetch" href="/assets/js/4.3c47b298.js"><link rel="prefetch" href="/assets/js/5.7e6d401b.js"><link rel="prefetch" href="/assets/js/6.0eda4d1f.js"><link rel="prefetch" href="/assets/js/7.97dfd014.js"><link rel="prefetch" href="/assets/js/8.0a01cecb.js"><link rel="prefetch" href="/assets/js/9.cda31825.js"><link rel="prefetch" href="/assets/js/10.1f2476b5.js"><link rel="prefetch" href="/assets/js/11.fdd9e01e.js"><link rel="prefetch" href="/assets/js/12.d75c28ef.js"><link rel="prefetch" href="/assets/js/14.0ab72b78.js"><link rel="prefetch" href="/assets/js/15.b31dc239.js"><link rel="prefetch" href="/assets/js/16.34f5a083.js">
    <link rel="stylesheet" href="/assets/css/0.styles.05224627.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">web开发（LAN/WLAN）</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/web development" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/web development" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>API Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/api/#createrenderer" class="sidebar-link">createRenderer</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/api/#createbundlerenderer" class="sidebar-link">createBundleRenderer</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/api/#class-renderer" class="sidebar-link">Class: Renderer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#renderer-rendertostring" class="sidebar-link">renderer.renderToString</a></li><li class="sidebar-sub-header"><a href="/api/#renderer-rendertostream" class="sidebar-link">renderer.renderToStream</a></li></ul></li><li><a href="/api/#class-bundlerenderer" class="sidebar-link">Class: BundleRenderer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#bundlerenderer-rendertostring" class="sidebar-link">bundleRenderer.renderToString</a></li><li class="sidebar-sub-header"><a href="/api/#bundlerenderer-rendertostream" class="sidebar-link">bundleRenderer.renderToStream</a></li></ul></li><li><a href="/api/#renderer-options" class="sidebar-link">Renderer Options</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#template" class="sidebar-link">template</a></li><li class="sidebar-sub-header"><a href="/api/#clientmanifest" class="sidebar-link">clientManifest</a></li><li class="sidebar-sub-header"><a href="/api/#inject" class="sidebar-link">inject</a></li><li class="sidebar-sub-header"><a href="/api/#shouldpreload" class="sidebar-link">shouldPreload</a></li><li class="sidebar-sub-header"><a href="/api/#shouldprefetch" class="sidebar-link">shouldPrefetch</a></li><li class="sidebar-sub-header"><a href="/api/#runinnewcontext" class="sidebar-link">runInNewContext</a></li><li class="sidebar-sub-header"><a href="/api/#basedir" class="sidebar-link">basedir</a></li><li class="sidebar-sub-header"><a href="/api/#cache" class="sidebar-link">cache</a></li><li class="sidebar-sub-header"><a href="/api/#directives" class="sidebar-link">directives</a></li><li class="sidebar-sub-header"><a href="/api/#serializer" class="sidebar-link">serializer</a></li></ul></li><li><a href="/api/#server-only-component-options" class="sidebar-link">Server-only Component Options</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/#servercachekey" class="sidebar-link">serverCacheKey</a></li><li class="sidebar-sub-header"><a href="/api/#serverprefetch" class="sidebar-link">serverPrefetch</a></li></ul></li><li><a href="/api/#webpack-plugins" class="sidebar-link">webpack Plugins</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="api-reference"><a href="#api-reference" aria-hidden="true" class="header-anchor">#</a> API Reference</h1> <h2 id="createrenderer"><a href="#createrenderer" aria-hidden="true" class="header-anchor">#</a> createRenderer</h2> <p>Create a <a href="#class-renderer"><code>Renderer</code></a> instance with (optional) <a href="#renderer-options">options</a>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> createRenderer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-server-renderer'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">/* options */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="createbundlerenderer"><a href="#createbundlerenderer" aria-hidden="true" class="header-anchor">#</a> createBundleRenderer</h2> <p>Create a <a href="#class-bundlerenderer"><code>BundleRenderer</code></a> instance with a server bundle and (optional) <a href="#renderer-options">options</a>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> createBundleRenderer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-server-renderer'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createBundleRenderer</span><span class="token punctuation">(</span>serverBundle<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">/* options */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The <code>serverBundle</code> argument can be one of the following:</p> <ul><li><p>An absolute path to generated bundle file (<code>.js</code> or <code>.json</code>). Must start with <code>/</code> to be treated as a file path.</p></li> <li><p>A bundle object generated by webpack + <code>vue-server-renderer/server-plugin</code>.</p></li> <li><p>A string of JavaScript code (not recommended).</p></li></ul> <p>See <a href="/guide/bundle-renderer.html">Introducing the Server Bundle</a> and <a href="/guide/build-config.html">Build Configuration</a> for more details.</p> <h2 id="class-renderer"><a href="#class-renderer" aria-hidden="true" class="header-anchor">#</a> Class: Renderer</h2> <h3 id="renderer-rendertostring"><a href="#renderer-rendertostring" aria-hidden="true" class="header-anchor">#</a> renderer.renderToString</h3> <p>Signature:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>renderer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> context<span class="token operator">?</span><span class="token punctuation">,</span> callback<span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>Promise<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Render a Vue instance to string. The context object is optional. The callback is a typical Node.js style callback where the first argument is the error and the second argument is the rendered string.</p> <p>In 2.5.0+, the callback is also optional. When no callback is passed, the method returns a Promise which resolves to the rendered HTML.</p> <h3 id="renderer-rendertostream"><a href="#renderer-rendertostream" aria-hidden="true" class="header-anchor">#</a> renderer.renderToStream</h3> <p>Signature:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>renderer<span class="token punctuation">.</span><span class="token function">renderToStream</span><span class="token punctuation">(</span>vm<span class="token punctuation">[</span><span class="token punctuation">,</span> context<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> stream<span class="token punctuation">.</span>Readable
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Render a Vue instance to a <a href="https://nodejs.org/dist/latest-v8.x/docs/api/stream.html#stream_readable_streams" target="_blank" rel="noopener noreferrer">Node.js readable stream<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The context object is optional. See <a href="/guide/streaming.html">Streaming</a> for more details.</p> <h2 id="class-bundlerenderer"><a href="#class-bundlerenderer" aria-hidden="true" class="header-anchor">#</a> Class: BundleRenderer</h2> <h3 id="bundlerenderer-rendertostring"><a href="#bundlerenderer-rendertostring" aria-hidden="true" class="header-anchor">#</a> bundleRenderer.renderToString</h3> <p>Signature:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>bundleRenderer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span><span class="token punctuation">[</span>context<span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>Promise<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Render the bundle to a string. The context object is optional. The callback is a typical Node.js style callback where the first argument is the error and the second argument is the rendered string.</p> <p>In 2.5.0+, the callback is also optional. When no callback is passed, the method returns a Promise which resolves to the rendered HTML.</p> <h3 id="bundlerenderer-rendertostream"><a href="#bundlerenderer-rendertostream" aria-hidden="true" class="header-anchor">#</a> bundleRenderer.renderToStream</h3> <p>Signature:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>bundleRenderer<span class="token punctuation">.</span><span class="token function">renderToStream</span><span class="token punctuation">(</span><span class="token punctuation">[</span>context<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> stream<span class="token punctuation">.</span>Readable
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Render the bundle to a <a href="https://nodejs.org/dist/latest-v8.x/docs/api/stream.html#stream_readable_streams" target="_blank" rel="noopener noreferrer">Node.js readable stream<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The context object is optional. See <a href="/guide/streaming.html">Streaming</a> for more details.</p> <h2 id="renderer-options"><a href="#renderer-options" aria-hidden="true" class="header-anchor">#</a> Renderer Options</h2> <h3 id="template"><a href="#template" aria-hidden="true" class="header-anchor">#</a> template</h3> <ul><li><strong>Type:</strong> <ul><li><code>string</code></li> <li><code>string | (() =&gt; string | Promise&lt;string&gt;)</code> (since 2.6)</li></ul></li></ul> <p><strong>If using a string template:</strong></p> <p>Provide a template for the entire page's HTML. The template should contain a comment <code>&lt;!--vue-ssr-outlet--&gt;</code> which serves as the placeholder for rendered app content.</p> <p>The template also supports basic interpolation using the render context:</p> <ul><li>Use double-mustache for HTML-escaped interpolation;</li> <li>Use triple-mustache for non-HTML-escaped interpolation.</li></ul> <p>The template automatically injects appropriate content when certain data is found on the render context:</p> <ul><li><p><code>context.head</code>: (string) any head markup that should be injected into the head of the page.</p></li> <li><p><code>context.styles</code>: (string) any inline CSS that should be injected into the head of the page. Note this property will be automatically populated if using <code>vue-loader</code> + <code>vue-style-loader</code> for component CSS.</p></li> <li><p><code>context.state</code>: (Object) initial Vuex store state that should be inlined in the page as <code>window.__INITIAL_STATE__</code>. The inlined JSON is automatically sanitized with <a href="https://github.com/yahoo/serialize-javascript" target="_blank" rel="noopener noreferrer">serialize-javascript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to prevent XSS.</p> <p>In 2.5.0+, the embed script also self-removes in production mode.</p> <p>In 2.6.0+, if <code>context.nonce</code> is present, it will be added as the <code>nonce</code> attribute to the embedded script. This allows the inline script to conform to CSP that requires nonce.</p></li></ul> <p>In addition, when <code>clientManifest</code> is also provided, the template automatically injects the following:</p> <ul><li>Client-side JavaScript and CSS assets needed by the render (with async chunks automatically inferred);</li> <li>Optimal <code>&lt;link rel=&quot;preload/prefetch&quot;&gt;</code> resource hints for the rendered page.</li></ul> <p>You can disable all automatic injections by also passing <code>inject: false</code> to the renderer.</p> <p><strong>If using a function template:</strong></p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Function template is only supported in 2.6+ and when using <code>renderer.renderToString</code>. It is NOT supported in <code>renderer.renderToStream</code>.</p></div> <p>The <code>template</code> option can also be function that returns the rendered HTML or a Promise that resolves to the rendered HTML. This allows you to leverage native JavaScript template strings and potential async operations in the template rendering process.</p> <p>The function receives two arguments:</p> <ol><li>The rendering result of the app component as a string;</li> <li>The rendering context object.</li></ol> <p>Example:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  template<span class="token punctuation">:</span> <span class="token punctuation">(</span>result<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`&lt;html&gt;
      &lt;head&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>context<span class="token punctuation">.</span>head<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/head&gt;
      &lt;body&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/body&gt;
    &lt;html&gt;`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Note that when using a custom template function, nothing will be automatically injected - you will be in full control of what the eventual HTML includes, but also will be responsible for including everything yourself (e.g. asset links if you are using the bundle renderer).</p> <p>See also:</p> <ul><li><a href="/guide/#using-a-page-template">Using a Page Template</a></li> <li><a href="/guide/build-config.html#manual-asset-injection">Manual Asset Injection</a></li></ul> <h3 id="clientmanifest"><a href="#clientmanifest" aria-hidden="true" class="header-anchor">#</a> clientManifest</h3> <p>Provide a client build manifest object generated by <code>vue-server-renderer/client-plugin</code>. The client manifest provides the bundle renderer with the proper information for automatic asset injection into the HTML template. For more details, see <a href="/guide/build-config.html#generating-clientmanifest">Generating clientManifest</a>.</p> <h3 id="inject"><a href="#inject" aria-hidden="true" class="header-anchor">#</a> inject</h3> <p>Controls whether to perform automatic injections when using <code>template</code>. Defaults to <code>true</code>.</p> <p>See also: <a href="/guide/build-config.html#manual-asset-injection">Manual Asset Injection</a>.</p> <h3 id="shouldpreload"><a href="#shouldpreload" aria-hidden="true" class="header-anchor">#</a> shouldPreload</h3> <p>A function to control what files should have <code>&lt;link rel=&quot;preload&quot;&gt;</code> resource hints generated.</p> <p>By default, only JavaScript and CSS files will be preloaded, as they are absolutely needed for your application to boot.</p> <p>For other types of assets such as images or fonts, preloading too much may waste bandwidth and even hurt performance, so what to preload will be scenario-dependent. You can control precisely what to preload using the <code>shouldPreload</code> option:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createBundleRenderer</span><span class="token punctuation">(</span>bundle<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token punctuation">,</span>
  clientManifest<span class="token punctuation">,</span>
  shouldPreload<span class="token punctuation">:</span> <span class="token punctuation">(</span>file<span class="token punctuation">,</span> type<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// type is inferred based on the file extension.</span>
    <span class="token comment">// https://fetch.spec.whatwg.org/#concept-request-destination</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'script'</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">'style'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'font'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// only preload woff2 fonts</span>
      <span class="token keyword">return</span> <span class="token operator">/</span>\<span class="token punctuation">.</span>woff2$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'image'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// only preload important images</span>
      <span class="token keyword">return</span> file <span class="token operator">===</span> <span class="token string">'hero.jpg'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="shouldprefetch"><a href="#shouldprefetch" aria-hidden="true" class="header-anchor">#</a> shouldPrefetch</h3> <ul><li>2.5.0+</li></ul> <p>A function to control what files should have <code>&lt;link rel=&quot;prefetch&quot;&gt;</code> resource hints generated.</p> <p>By default, all assets in async chunks will be prefetched since this is a low-priority directive; however you can customize what to prefetch in order to better control bandwidth usage. This option expects the same function signature as <code>shouldPreload</code>.</p> <h3 id="runinnewcontext"><a href="#runinnewcontext" aria-hidden="true" class="header-anchor">#</a> runInNewContext</h3> <ul><li>only used in <code>createBundleRenderer</code></li> <li>Expects: <code>boolean | 'once'</code> (<code>'once'</code> only supported in 2.3.1+)</li></ul> <p>By default, for each render the bundle renderer will create a fresh V8 context and re-execute the entire bundle. This has some benefits - for example, the app code is isolated from the server process and we don't need to worry about the <a href="/guide/structure.html#avoid-stateful-singletons">stateful singleton problem</a> mentioned in the docs. However, this mode comes at some considerable performance cost because re-executing the bundle is expensive especially when the app gets bigger.</p> <p>This option defaults to <code>true</code> for backwards compatibility, but it is recommended to use <code>runInNewContext: false</code> or <code>runInNewContext: 'once'</code> whenever you can.</p> <blockquote><p>In 2.3.0 this option has a bug where <code>runInNewContext: false</code> still executes the bundle using a separate global context. The following information assumes version 2.3.1+.</p></blockquote> <p>With <code>runInNewContext: false</code>, the bundle code will run in the same <code>global</code> context with the server process, so be careful about code that modifies <code>global</code> in your application code.</p> <p>With <code>runInNewContext: 'once'</code> (2.3.1+), the bundle is evaluated in a separate <code>global</code> context, however only once at startup. This provides better app code isolation since it prevents the bundle from accidentally polluting the server process' <code>global</code> object. The caveats are that:</p> <ol><li>Dependencies that modifies <code>global</code> (e.g. polyfills) cannot be externalized in this mode;</li> <li>Values returned from the bundle execution will be using different global constructors, e.g. an error caught inside the bundle will not be an instance of <code>Error</code> in the server process.</li></ol> <p>See also: <a href="/guide/structure.html">Source Code Structure</a></p> <h3 id="basedir"><a href="#basedir" aria-hidden="true" class="header-anchor">#</a> basedir</h3> <ul><li>only used in <code>createBundleRenderer</code></li></ul> <p>Explicitly declare the base directory for the server bundle to resolve <code>node_modules</code> dependencies from. This is only needed if your generated bundle file is placed in a different location from where the externalized NPM dependencies are installed, or your <code>vue-server-renderer</code> is NPM-linked into your current project.</p> <h3 id="cache"><a href="#cache" aria-hidden="true" class="header-anchor">#</a> cache</h3> <p>Provide a <a href="/guide/caching.html#component-level-caching">component cache</a> implementation. The cache object must implement the following interface (using Flow notations):</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>type RenderCache <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">:</span> string<span class="token punctuation">,</span> cb<span class="token operator">?</span><span class="token punctuation">:</span> Function<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> string <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">:</span> string<span class="token punctuation">,</span> val<span class="token punctuation">:</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  has<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">:</span> string<span class="token punctuation">,</span> cb<span class="token operator">?</span><span class="token punctuation">:</span> Function<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>A typical usage is passing in an <a href="https://github.com/isaacs/node-lru-cache" target="_blank" rel="noopener noreferrer">lru-cache<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">LRU</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lru-cache'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token constant">LRU</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    max<span class="token punctuation">:</span> <span class="token number">10000</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Note that the cache object should at least implement <code>get</code> and <code>set</code>. In addition, <code>get</code> and <code>has</code> can be optionally async if they accept a second argument as callback. This allows the cache to make use of async APIs, e.g. a Redis client:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      redisClient<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// handle error if any</span>
        <span class="token function">cb</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      redisClient<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="directives"><a href="#directives" aria-hidden="true" class="header-anchor">#</a> directives</h3> <p>Allows you to provide server-side implementations for your custom directives:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  directives<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">example</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> directiveMeta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// transform vnode based on directive binding metadata</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>As an example, check out <a href="https://github.com/vuejs/vue/blob/dev/src/platforms/web/server/directives/show.js" target="_blank" rel="noopener noreferrer"><code>v-show</code>'s server-side implementation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="serializer"><a href="#serializer" aria-hidden="true" class="header-anchor">#</a> serializer</h3> <blockquote><p>New in 2.6</p></blockquote> <p>Provide a custom serializer function for <code>context.state</code>. Since the serialized state will be part of your final HTML, it is important to use a function that properly escapes HTML characters for security reasons. The default serializer is <a href="https://github.com/yahoo/serialize-javascript" target="_blank" rel="noopener noreferrer">serialize-javascript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with <code>{ isJSON: true }</code>.</p> <h2 id="server-only-component-options"><a href="#server-only-component-options" aria-hidden="true" class="header-anchor">#</a> Server-only Component Options</h2> <h3 id="servercachekey"><a href="#servercachekey" aria-hidden="true" class="header-anchor">#</a> serverCacheKey</h3> <ul><li><p><strong>Type:</strong> <code>(props) =&gt; any</code></p> <p>Return the cache key for the component based on incoming props. Does NOT have access to <code>this</code>.</p> <p>Since 2.6, you can explicitly bail out of caching by returning <code>false</code>.</p> <p>See more details in <a href="/guide/caching.html#component-level-caching">Component-level Caching</a>.</p></li></ul> <h3 id="serverprefetch"><a href="#serverprefetch" aria-hidden="true" class="header-anchor">#</a> serverPrefetch</h3> <ul><li><p><strong>Type:</strong> <code>() =&gt; Promise&lt;any&gt;</code></p> <p>Fetch async data during server side rendering. It should store fetched data into a global store and return a Promise. The server renderer will wait on this hook until the Promise is resolved. This hook has access to the component instance via <code>this</code>.</p> <p>See more details in <a href="/guide/data.html">Data Fetching</a>.</p></li></ul> <h2 id="webpack-plugins"><a href="#webpack-plugins" aria-hidden="true" class="header-anchor">#</a> webpack Plugins</h2> <p>The webpack plugins are provided as standalone files and should be required directly:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> VueSSRServerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-server-renderer/server-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> VueSSRClientPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-server-renderer/client-plugin'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The default files generated are:</p> <ul><li><code>vue-ssr-server-bundle.json</code> for the server plugin;</li> <li><code>vue-ssr-client-manifest.json</code> for the client plugin.</li></ul> <p>The filenames can be customized when creating the plugin instances:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueSSRServerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  filename<span class="token punctuation">:</span> <span class="token string">'my-server-bundle.json'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>See <a href="/guide/build-config.html">Build Configuration</a> for more information.</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后一次更新时间: </span> <span class="time">2020-6-17 18:32:24</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/13.7e3b4d4d.js" defer></script><script src="/assets/js/app.f71b7fe6.js" defer></script>
  </body>
</html>
